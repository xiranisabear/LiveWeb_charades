<html>

<head>
	<script type="text/javascript" src="/socket.io/socket.io.js"></script>
	<script type="text/javascript">

var choosen = false;

		window.addEventListener('load', function() {
			let canvas = document.getElementById('thecanvas');
			let context = canvas.getContext('2d');

			let px = -1;
			let py = -1;


			canvas.addEventListener('mousemove', function(evt) {
if (choosen) {
				var rect = canvas.getBoundingClientRect();

				let x = evt.clientX - rect.left;
				let y = evt.clientY - rect.top;


				var thedata = {x: evt.clientX - rect.left,y: evt.clientY - rect.top};
				console.log(thedata);
				socket.emit('draw', thedata);
        console.log(thedata);

				if (px != -1) {
					context.beginPath();
					context.moveTo(px, py);
					context.lineTo(x,y);
					context.stroke();
				}

				px = x;
				py = y;
}
			});

		});


		var socket = io.connect();

		let px = -1;
		let py = -1;

		socket.on('draw', function(data) {
			console.log(data);
			let canvas = document.getElementById('thecanvas');
			let context = canvas.getContext('2d');
			//var rect = canvas.getBoundingClientRect();

			if (px != -1) {
				context.beginPath();
				context.moveTo(px, py);
				context.lineTo(data.x, data.y);
				context.stroke();
			}

			px = data.x;
			py = data.y;

		});

		socket.on('socketid', function(data) {
			console.log(data);
		});

		socket.on('painter', function(data) {

			if (data == "you"){
				choosen = true;
			}
			// console.log("the chosen one: " + data.x);
			// console.log("Your ID is: " + data.y);
      //
			// if(data.x == data.y){
			// 	console.log("you are chosen!");
			// 	//then make the chosen one the "moderator"
			// 	choosen = true;
			// }

		});


		socket.on('connect', function() {
			console.log("Connected");
		});


	</script>
</head>

<body>
	<canvas width="400" height="400" id="thecanvas">hi</canvas>
	<!-- <canvas width="400" height="400" id="thecanvas2">hi</canvas> -->

</body>

</html>
